# FCB1010 Sound Player

## 概要

ベリンガーのFCB1010 MIDIフットコントローラーからのMIDI信号を受け取り、各スイッチに対応するフォルダ内の音声ファイルをランダムに再生するPythonスクリプトです。左のエクスプレッションペダルで出力ボリュームをコントロールできます。MIDI機器の選択、音声ファイルの一覧、再生状態（緑色の背景で表示）、MIDI入力レベル、オーディオ出力レベルを可視化するGUIウィンドウを備えています。

**主な特徴:**

*   **ランダム再生:** 各スイッチに対応するフォルダ内の音声ファイルをランダムに選択して再生。
*   **ループ再生:** スイッチを押し続けると音声ファイルをループ再生。
*   **ボリュームコントロール:** 左のエクスプレッションペダルで出力ボリュームを調整。
*   **GUI:** MIDI/オーディオデバイス選択、ファイルリスト、再生状況、レベルメーターを備えたGUI。
*   **再生キュー:** あるスイッチの音声が再生中に別の音声がリクエストされた場合、再生中の音声が終了した後に、キューに追加された音声を再生。
*   **フェードアウト:** スイッチを離したときに、再生中の音声を滑らかにフェードアウト。

## 動作環境

*   Python 3.6 以上
*   必要なライブラリ:
    *   mido
    *   pygame
    *   PyQt5
*   FCB1010 MIDIフットコントローラー
*   オーディオ出力デバイス (サウンドカード、オーディオインターフェースなど)
*   OS: Windows, macOS, Linux (Ubuntu での動作確認済み)

## フォルダ構造

スクリプトと同じディレクトリに、`1` から `10` までの名前のフォルダを作成してください。各フォルダには、対応するFCB1010のスイッチで再生したい音声ファイル (wav, mp3, ogg 形式) を配置します。

fcb1010_sound_player.py  <-- このREADME.mdと同じ場所に配置
1/
sound1.wav
sound2.mp3
2/
sound3.ogg
...
10/
sound4.wav


## インストール方法

### 1. Pythonのインストール

Python 3.6 以上がインストールされていることを確認してください。まだインストールされていない場合は、公式サイトからダウンロードしてインストールしてください。

*   Python公式サイト: [https://www.python.org/downloads/](https://www.python.org/downloads/)

### 2. 必要なライブラリのインストール

`pip` コマンドを使用して、必要なライブラリをインストールします。

```bash
pip install mido pygame pyqt5
3. スクリプトとフォルダの準備
このリポジトリをクローンするか、fcb1010_sound_player.py ファイルをダウンロードします。
上記「フォルダ構造」に従って、1 から 10 までのフォルダを作成し、各フォルダに音声ファイルを配置します。
使い方
FCB1010 を PC に接続します。

ターミナル (Windows ではコマンドプロンプト) を開き、fcb1010_sound_player.py ファイルが置かれているディレクトリに移動します。

以下のコマンドでスクリプトを実行します。

Bash

python fcb1010_sound_player.py
GUIウィンドウが表示されます。

"MIDI Input Device" ドロップダウンリストから、FCB1010 を選択します。
"Audio Output Device" ドロップダウンリストから、音声を出力するデバイスを選択します。
FCB1010 のスイッチを押すと、対応するフォルダ内の音声ファイルがランダムに再生されます。

スイッチを押し続けると、音声ファイルがループ再生されます。
再生中に別のスイッチを押した場合の動作:
現在再生中の音声は、そのまま再生が続きます（またはフェードアウトします）。
新しく押されたスイッチに対応する音声は、再生キューに追加されます。
現在再生中の音声が終了した後に、キューに追加されていた音声が再生されます。
スイッチを離すと、再生中の音声が滑らかにフェードアウトします。
再生中のファイルは、ファイルリスト内で緑色の背景で表示されます。
FCB1010 の左側のエクスプレッションペダルで、出力ボリュームを調整できます。

MIDI Input LevelおよびAudio Output Levelでそれぞれのレベルが確認できます。

Ubuntu でのデプロイ方法
Ubuntu (およびその他のDebianベースのディストリビューション) では、以下の手順でセットアップできます。

Python 3 と pip のインストール (通常はデフォルトでインストールされています):

Bash

sudo apt update
sudo apt install python3 python3-pip
必要なライブラリのインストール:

Bash

pip3 install mido pygame pyqt5
場合によっては、pygame のインストールに追加のシステムライブラリが必要になることがあります。

     sudo apt-get install libsdl-image1.2-dev libsdl-mixer1.2-dev libsdl-ttf2.0-dev libsdl1.2-dev libsmpeg-dev python-nu 1 mpy
```
3. portmidi(midoのバックエンドで使用)をインストール   
1.
github.com
github.com

Bash

 sudo apt-get install portmidi
スクリプトとフォルダの準備 (上記「スクリプトとフォルダの準備」と同じ).

スクリプトの実行:

Bash

python3 fcb1010_sound_player.py
トラブルシューティング
MIDI デバイスが認識されない:

FCB1010 が正しく接続されていることを確認してください。
他の MIDI アプリケーションで FCB1010 が認識されるか確認してください。
mido.get_input_names() を実行して、利用可能な MIDI 入力デバイスのリストを確認し、FCB1010 が含まれているか確認してください。
音が出ない:

オーディオ出力デバイスが正しく選択されていることを確認してください。
システムの音量設定がミュートになっていないか、または小さすぎないか確認してください。
音声ファイルの形式が pygame でサポートされている形式 (wav, mp3, ogg) であることを確認してください。
pygameの初期化でエラーが出ていないか確認してください。
GUI が表示されない/エラーが発生する:

PyQt5 が正しくインストールされていることを確認してください。
Python のバージョンが 3.6 以上であることを確認してください。
ターミナルに表示されるエラーメッセージを確認してください。
ライセンス
このスクリプトは MIT ライセンスの下で公開されています。詳細については、LICENSE ファイル (もしあれば) を参照してください。

謝辞
mido: MIDIライブラリ
pygame: オーディオ再生
PyQt: GUIフレームワーク
